name: code-complexity-check
description: Analyzes code complexity metrics to identify functions needing refactoring

# Fire CLI exports - defines which objects/functions to expose
exports:
  - name: analyze
    type: function
    object: analyze

schema:
  input:
    type: object
    required: [file_path]
    properties:
      file_path:
        type: string
        description: Path to the code file to analyze
      threshold:
        type: number
        default: 10
        description: Complexity threshold (functions above this are flagged)
      language:
        type: string
        enum: [python, javascript, typescript, auto]
        default: auto
        description: Programming language (auto-detect if not specified)
  
  output:
    type: object
    required: [status, file]
    properties:
      status:
        type: string
        enum: [success, error]
        description: Analysis status
      file:
        type: string
        description: Analyzed file path
      language:
        type: string
        description: Detected or specified language
      threshold:
        type: number
        description: Complexity threshold used
      flagged_functions:
        type: array
        description: Functions exceeding complexity threshold
        items:
          type: object
          required: [function, complexity, line]
          properties:
            function:
              type: string
              description: Function name
            complexity:
              type: number
              description: Cyclomatic complexity score
            line:
              type: number
              description: Line number where function starts
            rank:
              type: string
              description: Complexity rank (A-F)
      summary:
        type: object
        properties:
          total_flagged:
            type: integer
            description: Number of functions exceeding threshold
          recommendations:
            type: array
            items:
              type: string
            description: Refactoring suggestions
      error:
        type: string
        description: Error message if analysis failed

implementation:
  language: python
  entry: script.py
